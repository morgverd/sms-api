# [REQUIRED] Database Configuration.
[database]
# [REQUIRED] An absolute path to the SQLite database that is used to store messages.
database_url = "/home/pi/sms-database.db"

# [REQUIRED] 32 byte encryption key, base-64 encoded. This is used to encrypt message content within the database.
# Generate with: openssl rand -base64 32.
encryption_key = "PUT_YOUR_BASE64_ENCRYPTION_KEY_HERE"

# --------------------------------------------------------------------------------
# [OPTIONAL] Modem Configuration.
[modem]
# The modem serial device path.
device = "/dev/ttyS0"

# The baud rate to use when creating device connection.
baud = 115200

# If the Modem GNSS module should be enabled. This requires the antenna to be connected to the modem.
# By default, this is disabled as if the antenna isn't connected worker initialization will fail.
gnss_enabled = false

# Sets AT+CGNSURC interval (in seconds), this causes the modem to send unsolicited position reports which are sent as events.
# If set to zero (default) the modem does not send these position reports, however it can still be accessed via HTTP (GET /gnss/location).
gnss_report_interval = 0

# Should GPIO pin 4 (Waveshare Hat power-pin) be toggled if initial connection test fails?
# This ensures the hat is always powered after a system restart etc.
gpio_power_pin = false

# Should the GPIO power pin be toggled during failed reconnection attempts? This allows the modem to be powered on
# if it somehow is powered off during operation (by default, pin control prevents the button from working).
gpio_repower = false

# Buffer size for Modem command sender channel. This is bound to ensure that slow command responses don't result in
# unexpected backpressure as we keep adding new commands to the queue. If the queue is full, API requests are rejected.
cmd_channel_buffer_size = 32

# Buffer size used for readign data from the serial port. This determines how much data can be read in a single operation,
# larger values will improve throughput by reading more data per system call however it uses more memory.
read_buffer_size = 4096

# Buffer size for the maximum size that the internal buffer size can grow to before old data is discarded.
# This determines how much data is kept for processing complte lines and large responses.
line_buffer_size = 4096

# --------------------------------------------------------------------------------
# [OPTIONAL] HTTP Server Configuration.
[http]
# If the HTTP server should be started. By default, this is false. Without the HTTP server, this effectively just
# becomes an SMS reciever which can use the webhooks to forward them since the HTTP API is required for sending.
# There should also be an SMS_HTTP_AUTH_TOKEN environment variable set to authenticate HTTP requests.
enabled = true

# The bind address used for the HTTP TcpListener.
address = "0.0.0.0:3000"

# Should the SMS Send route only accept international number formats (eg: +44....)?
# This prevents sending to internal carrier numbers which could be used to check balance etc.
send_international_format_only = true

# Should authentication middleware be added? This requires that all requests (include websocket upgrades) have an
# Authorization header that matches environment variable SMS_HTTP_AUTH_TOKEN (it will panic if this is missing).
require_authentication = true

# Should the websocket event route (/ws) be served?
websocket_enabled = true

# An optional phone number that is returned in /sys/phone-number. This is used as a unique identifier for client discovery.
phone_number = "+44..."

# --------------------------------------------------------------------------------
# [OPTIONAL] Sentry error tracking and monitoring (requires sentry feature to be enabled)
[sentry]
# [REQUIRED] Your Sentry project DSN URL - get this from your Sentry project settings.
dsn = "https://abc123@sentry.io/1"

# Environment name to categorize deployments (e.g., dev, staging, production).
environment = "dev"

# A descriptive name for this server instance to help identify it in Sentry.
server_name = "Identifable Name"

# Whether to include personally identifiable information in error reports.
send_default_pii = false

# Should Sentry log debug information to stdout (not through the application logger).
# Only use this when trying to diagnose Sentry specific issues.
debug = false

# --------------------------------------------------------------------------------
# Webhook Configuration Examples.
# You can define multiple webhooks with different configurations.

# Example 1: Basic webhook (receives only "Incoming" events).
[[webhooks]]
url = "https://webhook-a.example.org"

# Example 2: Webhook with custom headers (for authentication).
[[webhooks]]
url = "https://webhook-b.example.org"

[webhooks.headers]
Authorization = "Bearer your-token-here"
X-Other = "custom-header-value"

# Example 3: Webhook with specific event filtering.
[[webhooks]]
url = "https://webhook-c.example.org"
events = ["incoming", "outgoing", "delivery"]
